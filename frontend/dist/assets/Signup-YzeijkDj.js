import{u as L,b as j,a as M,r as d,j as e,N as P,q,s as O,t as D,v as F,i as m,c as U,L as z,z as A}from"./index-DdC0FHAS.js";const $=()=>{var b;const w=L(),{error:R,loading:h}=j(r=>r.auth),{isAuthenticated:f}=j(r=>r.auth),x=M(),[_,v]=d.useState(!1),[i,N]=d.useState({email:"",username:"",first_name:"",last_name:"",password1:"",password2:""}),[t,p]=d.useState({}),[l,o]=d.useState({}),{email:y,username:S,first_name:E,last_name:k,password1:I,password2:B}=i;d.useEffect(()=>{f&&x("/")},[f,x]);const g=(r,a)=>{let s="";switch(r){case"email":a?/\S+@\S+\.\S+/.test(a)||(s="Email is invalid"):s="Email is required";break;case"username":a?a.trim().length<3&&(s="Username must be at least 3 characters long"):s="Username is required";break;case"first_name":case"last_name":a||(s=`${r==="first_name"?"First":"Last"} name is required`);break;case"password1":a?a.trim().length<8&&(s="Password must be at least 8 characters long"):s="Password is required";break;case"password2":a?a!==i.password1&&(s="Passwords do not match"):s="Please confirm your password";break}return s},c=r=>{const{name:a,value:s}=r.target;N({...i,[a]:s}),o({...l,[a]:!0})};d.useEffect(()=>{const r={};Object.keys(i).forEach(a=>{if(l[a]){const s=g(a,i[a]);s&&(r[a]=[s])}}),p(r)},[i,l]);const C=async r=>{r.preventDefault();const a={};if(Object.keys(i).forEach(s=>{const u=g(s,i[s]);u&&(a[s]=[u])}),Object.keys(a).length===0)try{await w(A(i)).unwrap(),v(!0)}catch(s){console.log(s,"k"),p(s||{})}else p(a),o(Object.keys(i).reduce((s,u)=>({...s,[u]:!0}),{}))},n=r=>t[r]&&t[r].length>0;return _?e.jsx(P,{to:"../"}):e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx(q,{className:"w-2/3",children:e.jsxs(O,{children:[e.jsx(D,{className:"flex flex-col",children:e.jsx("h4",{className:"font-bold  text-3xl",children:"Level Up"})}),e.jsx(F,{}),e.jsx("p",{className:"text-2xl text-default-500 text-center mb-1",children:"Sign up"}),e.jsxs("form",{className:"mb-3",onSubmit:C,children:[e.jsx("div",{className:"mb-3",children:e.jsx(m,{name:"first_name",value:E,onChange:c,onBlur:()=>o({...l,first_name:!0}),type:"text",id:"first_name",label:"First Name",isInvalid:n("first_name"),errorMessage:n("first_name")?t.first_name[0]:""})}),e.jsx("div",{className:"mb-3",children:e.jsx(m,{name:"last_name",value:k,onChange:c,onBlur:()=>o({...l,last_name:!0}),type:"text",id:"last_name",label:"Last Name",isInvalid:n("last_name"),errorMessage:n("last_name")?t.last_name[0]:""})}),e.jsx("div",{className:"mb-3",children:e.jsx(m,{name:"email",value:y,onChange:c,onBlur:()=>o({...l,email:!0}),type:"email",id:"email",label:"Email",isInvalid:n("email"),errorMessage:n("email")?t.email[0]:""})}),e.jsx("div",{className:"mb-3",children:e.jsx(m,{name:"username",value:S,onChange:c,onBlur:()=>o({...l,username:!0}),type:"text",id:"username",label:"Username",isInvalid:n("username"),errorMessage:n("username")?t.username[0]:""})}),e.jsx("div",{className:"mb-3",children:e.jsx(m,{name:"password1",value:I,onChange:c,onBlur:()=>o({...l,password1:!0}),type:"password",id:"password1",label:"Password",isInvalid:n("password1"),errorMessage:n("password1")?t.password1[0]:""})}),e.jsx("div",{className:"mb-3",children:e.jsx(m,{name:"password2",value:B,onChange:c,onBlur:()=>o({...l,password2:!0}),type:"password",id:"password2",label:"Repeat Password",isInvalid:n("password2"),errorMessage:n("password2")?t.password2[0]:""})}),e.jsx("p",{className:"text-red-500",children:(b=t==null?void 0:t.non_field_errors)==null?void 0:b.join(", ")}),e.jsx("div",{className:"d-grid gap-2 justify-center",children:e.jsx(U,{className:"btn-custom-green mx-auto",size:"lg",type:"submit",disabled:h||Object.keys(t).length>0,children:h?"Signing up...":"Signup"})})]}),e.jsxs("p",{className:"text-center",children:["Already have an account? ",e.jsx(z,{to:"../login/",className:" text-blue-400",children:"Login"})]})]})})})};export{$ as default};
