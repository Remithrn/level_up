import{r,b as x,u as S,aw as y,j as e,c as h,B as k,D as E,E as $,F as D,i as g,aY as F,aZ as L,I as A,aQ as v,C as B,v as _,L as M}from"./index-DdC0FHAS.js";import{u as O}from"./index-DmNmbST7.js";const z=({setChanged:c})=>{const{isOpen:d,onOpen:i,onOpenChange:l}=O(),[o,s]=r.useState(""),[a,p]=r.useState(""),{access:m}=x(t=>t.auth),[N,f]=r.useState(!1),{friends_list:j}=x(t=>t.profile),[u,b]=r.useState([]),C=S();r.useEffect(()=>{C(y()),console.log("dj"),console.log(j,"friend_list")},[m]);const G=async()=>{console.log(o,a,u);const t=u.map(n=>n.user_id);console.log(t),f(!0);try{const n=await v.post("http://localhost:8000/api/chat/group-chats/",{name:o,description:a,user_ids:t},{headers:{Authorization:`Bearer ${m}`}});console.log(n.data),c(w=>!w),f(!1),s(""),p(""),b([]),l()}catch(n){console.error("Error creating group:",n)}};return e.jsxs("div",{children:[e.jsx(h,{className:"hidden items-center gap-2 self-start rounded-2xl border-b-4 border-green-500 bg-green-400 px-5 py-6 font-bold uppercase text-white transition hover:brightness-110 md:flex",onClick:i,children:"Create Group"}),e.jsx(k,{isOpen:d,onOpenChange:l,children:e.jsxs(E,{children:[e.jsx($,{children:e.jsx("h1",{className:"text-2xl font-bold",children:"Create Group"})}),e.jsxs(D,{children:[e.jsx(g,{label:"Group Name",value:o,onChange:t=>s(t.target.value)}),e.jsx(g,{label:"Description",value:a,onChange:t=>p(t.target.value)}),e.jsx(F,{label:"Group Members",placeholder:"Select friends",selectionMode:"multiple",className:"max-w-xs",children:j.map(t=>e.jsx(L,{onClick:()=>b([...u,t]),children:t.username},t.id))})]}),e.jsxs(A,{children:[e.jsx(h,{onClick:l,children:"Cancel"}),e.jsx(h,{onClick:G,isLoading:N,children:"Create"})]})]})})]})},R=()=>{const[c,d]=r.useState([]),{access:i}=x(s=>s.auth),[l,o]=r.useState(!1);return r.useEffect(()=>{v.get("http://localhost/api/chat/group-chats/",{headers:{Authorization:`Bearer ${i}`}}).then(s=>{d(s.data)})},[i,l]),e.jsx(B,{children:e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 border-b pb-4  uppercase",children:"Group Chat"}),e.jsx(_,{}),e.jsx("div",{className:"space-y-6",children:c.length>0?c.map(s=>e.jsxs("div",{className:"flex flex-col items-start gap-2 self-start rounded-2xl border-b-4 border-violet-500 bg-violet-400 px-5 py-6 font-bold uppercase text-white transition hover:brightness-110 md:flex",children:[e.jsx(M,{to:`/group-chat/${s.id}`,className:"text-2xl font-bold text-white block transition-colors hover:text-gray-200",children:s.name}),e.jsx(_,{className:"bg-white"}),s.admins.length>0&&e.jsxs("p",{className:"text-white",children:["Admin: ",s.admins.map(a=>a.user.username).join(", ")]}),e.jsxs("p",{className:"text-white",children:["Members: ",s.users.length>3?`${s.users.slice(0,3).map(a=>a.username).join(", ")}, and ${s.users.length-3} more`:s.users.map(a=>a.username).join(", ")]})]},s.id)):e.jsx("p",{className:"text-gray-500 text-center text-lg",children:"No group chats available."})}),e.jsx("div",{className:"mt-8",children:e.jsx(z,{setChanged:o})})]})})};export{R as default};
